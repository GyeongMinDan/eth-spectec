Cherry-picked from the Petr4 repository.
